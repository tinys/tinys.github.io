/**combine by hugjs**/
define("uicomp/DragSort",function(t){function e(t,e){var n=this;e=e||{},n.itemQuery=e.itemQuery||"[dragitem='1']",n.dragOut=e.dragOut||!1,n.layer=t,s.extend(n,a()),n.init()}function n(t,e){t.style.cssText=e.cssText()}var i=t,r="ontouchstart"in window,o=navigator.msPointerEnabled,s=t,a=i("core/model"),c=i("core/event"),u=i("core/cssText"),l=window.Math,f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};return e.prototype.init=function(){var t=this;t.disable=!1,t.currentElement=!1,t.currentDestElement=!1,t.initEvent(!0),t.refresh()},e.prototype.initEvent=function(t){var e=this,n=t?c.addEvent:c.removeEvent,i=e.layer;r?(n(i,"touchstart",e),n(window,"orientationchange",e)):o?n(i,"MSPointerDown",e):(n(i,"mousedown",e),n(window,"resize",e))},e.prototype.initWinEvent=function(t){var e=this,n=t?c.addEvent:c.removeEvent;r?(n(window,"touchmove",e),n(window,"touchend",e),n(window,"touchcancel",e)):o?(n(window,"MsPointerMove",e),n(window,"MsPointerUp",e),n(window,"MsPointerCancel",e)):(n(window,"mousemove",e),n(window,"mouseup",e))},e.prototype.handleEvent=function(t){var e=t.type,n=this;if(!n.disable)switch(e){case"touchstart":case"MSPointerDown":case"mousedown":n._start(t);break;case"touchmove":case"MsPointerMove":case"mousemove":n._move(t);break;case"touchend":case"touchcancel":case"MsPointerUp":case"MsPointerCancel":case"mouseup":n._end(t);break;case"resize":n._resize(t)}},e.prototype.getDragElement=function(t){function e(t){return t==i.layer||t==document.body?null:"1"==t.getAttribute("dragitem")?t:e(t.parentNode)}var n=t.target,i=this;return e(n)},e.prototype._start=function(t){var e=this,i=t.targetTouches?t.targetTouches[0]:t,r=e.getDragElement(i);if(r){e.currentElement=r,e.currentDestElement=r,e._pushToOuter(e.currentElement),e.touchStartX=i.pageX,e.touchStartY=i.pageY;var o=JSON.parse(e.currentElement.getAttribute("position"));o.display="",e.startX=e.x=parseInt(o.left),e.startY=e.y=parseInt(o.top),e.layerWidth=parseInt(parseInt(o.width)),e.layerHeight=parseInt(parseInt(o.height)),n(e.moveLayer,e.moveCssText.css(o)),e.initWinEvent(!0),e.trigger("drag",e.currentElement),c.stopEvent(t)}},e.prototype._move=function(t){var e=this,i=t.targetTouches?t.targetTouches[0]:t,r=i.pageX-e.touchStartX,o=i.pageY-e.touchStartY;e.touchStartX=i.pageX,e.touchStartY=i.pageY,e.x+=r,e.y+=o,n(e.moveLayer,e.moveCssText.css({left:e.x+"px",top:e.y+"px"}));for(var s=e.x+e.layerWidth/2,a=e.y+e.layerHeight/2,u=!1,f=null,h=e.child.length;h--;){var d=e.child[h],p=JSON.parse(d.getAttribute("position")),m=parseInt(p.width)/2,v=parseInt(p.height)/2,g=parseInt(p.left)+m,y=parseInt(p.top)+v,w=l.sqrt(l.pow(g-s,2)+l.pow(y-a,2)),E=l.sqrt(l.pow(m,2)+l.pow(v,2));E>w&&(f>w||null===f)&&(f=w,u=d)}var b=e.currentDestElement;e.currentDestElement=u,e.trigger("over",e.currentDestElement,b),c.stopEvent(t)},e.prototype._end=function(t){var e=this;if(e.currentElement){var n=e._removeFormOuter();c.stopEvent(t);var i="exchange";e.currentDestElement&&e.currentDestElement!=e.currentElement?(e.currentDestElement.parentNode.replaceChild(n,e.currentDestElement),e.currentElement.parentNode.replaceChild(e.currentDestElement,e.currentElement),e.refresh()):(e.currentElement.parentNode.replaceChild(n,e.currentElement),i="nochange"),e.currentElement=!1,e.currentDestElement=!1,e.initWinEvent(!1),e.refresh(),e.trigger(i)}},e.prototype._resize=function(){this.refresh()},e.prototype._pushToOuter=function(t){var e=this;e.moveLayer||(e.moveLayer=document.createElement("div"),e.moveLayer.className="drag-float",e.moveCssText=u("display:none;position:absolute;top:0px;left:0px;"),n(e.moveLayer,e.moveCssText),document.body.appendChild(e.moveLayer));var i=t.cloneNode(!0);e.moveLayer.appendChild(i)},e.prototype._removeFormOuter=function(){var t=this,e=t.moveLayer.children[0];return e&&t.moveLayer.removeChild(e),n(t.moveLayer,t.moveCssText.css({display:"none"})),e},e.prototype.suspen=function(){this.disable=!0},e.prototype.refresh=function(){var t=this;f(function(){t.child=t.layer.querySelectorAll(t.itemQuery);for(var e=t.child.length,n=0;e>n;n++){var i=t.child[n].getBoundingClientRect();t.child[n].setAttribute("position",JSON.stringify({width:i.width+"px",height:i.height+"px",left:i.left+"px",top:i.top+"px"}))}})},e.prototype.enable=function(){this.disable=!1},e.prototype.destory=function(){var t=this;t.initEvent(!1),t.initWinEvent(!1)},e});